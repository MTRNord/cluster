apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: kube-prometheus
  namespace: monitoring
spec:
  values:
    grafana:
      alerting:
        contactpoints.yaml:
          apiVersion: 1
          contactPoints:
            - orgId: 1
              name: 'MidnightThoughts Ops'
              receivers:
                - uid: '1'
                  name: 'MidnightThoughts Ops'
                  type: 'email'
                  sendReminder: true
                  frequency: '1m'
                  settings:
                    addresses: 'ops@nordgedanken.dev'
                    subject: |
                      '{{ template "default.title" . }}'
      ingress:
        enabled: true
        hosts:
          - grafana.midnightthoughts.space
        tls:
          - secretName: grafana.midnightthoughts.space
            hosts:
              - grafana.midnightthoughts.space
      grafana.ini:
        server:
          root_url: https://grafana.midnightthoughts.space
