apiVersion: v1
kind: ConfigMap
metadata:
    name: mysql-configmap
    namespace: blog
data:
    init.sql: |
        CREATE USER '$MYSQL_USER'@'%' IDENTIFIED BY '$MYSQL_PASSWORD';
        GRANT ALL PRIVILEGES ON '$MYSQL_DATABASE'.* TO '$MYSQL_USER'@'%';
        FLUSH PRIVILEGES;
---
apiVersion: v1
kind: ConfigMap
metadata:
    name: mysql-config
    namespace: blog
data:
    performance.cnf: |
        [mysqld]
        innodb_buffer_pool_size = 3G
        innodb_buffer_pool_instances = 4
        innodb_io_capacity = 2000
        innodb_io_capacity_max = 4000
        innodb_read_io_threads = 4
        innodb_write_io_threads = 4
        innodb_file_per_table = 1
        innodb_log_file_size = 512M
        thread_cache_size = 16
        thread_handling = pool-of-threads
        thread_pool_size = 4
        thread_cache_size = 48
        query_cache_size = 128M
        query_cache_type = 1
        table_open_cache = 4096
        table_definition_cache = 1024
        table_open_cache_instances = 4
        join_buffer_size = 4M
        sort_buffer_size = 6M
        read_rnd_buffer_size = 2M
        tmp_table_size = 64M
        max_heap_table_size = 64M
        max_allowed_packet = 64M
        performance_schema = ON

        max_connections = 150
