apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: sentry
  namespace: sentry
spec:
  releaseName: sentry
  chart:
    spec:
      chart: sentry
      version: 27.8.x
      sourceRef:
        kind: HelmRepository
        name: sentry
  interval: 60m
  timeout: 20m0s
  values:
    ipv6: true
    user:
      create: true
      email: mtrnord@nordgedanken.dev
      password: ENC[AES256_GCM,data:cNAr+rp9PYzS,iv:9nY2PSgtNKLNPrwIdgUhyZUayKML+CjusHPnUOIRIl4=,tag:cJVdGTv7gjVpRQ/HKgy4gg==,type:str]
    # this is required on the first installation, as sentry has to be initialized first
    # recommended to set false for updating the helm chart afterwards,
    # as you will have some downtime on each update if it's a hook
    # deploys relay & snuba consumers as post hooks
    asHook: true
    hooks:
      dbCheck:
        image:
          repository: toolbelt/netcat
          tag: latest
          pullPolicy: Always
    vroom:
      persistence:
        enabled: true
        size: 5Gi
        accessMode: ReadWriteMany
        storageClass: longhorn
    geodata:
      persistence:
        storageClass: longhorn
    sentry:
      singleOrganization: true
      web:
        enabled: true
      features:
        orgSubdomains: false
        enableProfiling: false
        enableSessionReplay: true
        enableFeedback: true
        enableSpan: true
        enableUptime: false
      ingestFeedback:
        enabled: true
    system:
      url: https://sentry.mtrnord.blog
      adminEmail: ENC[AES256_GCM,data:uLxQEeEJyFJk8skjeNErXWQu9+ZGdL5DIaRX7+gG,iv:9+8004rHvxMU21ROm2paIC/EowS8HmBnzHd89TVeo7Y=,tag:prtTpllyBgUrD65vLYAsww==,type:str]
      public: false
      secretKey: ENC[AES256_GCM,data:VvQwsNpUL2hkyEXRyFl8s/8wRRvqTSjUVPlaGLeutlf+A3MxSY+kYhNDvIxO7p9UC7WwhEBirf+xKOwow+KQJA==,iv:kzf/ZcdIURDcqF7XeqBJUmclX4kWHZ/IgzvXzU/S3k0=,tag:gYYX3ZA3Uk9lJWQkWIsMYw==,type:str]
    mail:
      backend: smtp
      host: mail.midnightthoughts.space
      useTls: "true"
      useSsl: "false"
      port: "587"
      username: support@midnightthoughts.space
      password: ENC[AES256_GCM,data:XI0FVMUnFFmP9RMOlRmrpsUyU5dAY91BBtY8lZTAzRWXJVxvuqaXQUgwcacFYqoUR+g+hNfARGmNO6VkwTegMw==,iv:Bo7ZVxplDS/GsfN+gtEYbvEz8SLGMZYMoq32XNHYXH0=,tag:ibLMvFE+kBrVPaYQVjAGlg==,type:str]
      from: support@midnightthoughts.space
    github:
      appId: ENC[AES256_GCM,data:qSWfo8Bv+w==,iv:SA3I94VV2Bawg0y/YAN5AOHgyAXT2oUft2jnSgCEh0I=,tag:Mf5w6vI15I6zfHUIU5Tp4A==,type:str]
      appName: Sentry Midnightthoughts
      clientId: ENC[AES256_GCM,data:cZ2OBEAgx2bi3F3IxClA8OrDGHg=,iv:DJ/evjaZDhUl5iqjW0LtX/3MB4gqGdLwMSm5QykjvS0=,tag:LsoFJgUiD7ryQpLukOV1Og==,type:str]
      clientSecret: ENC[AES256_GCM,data:uZXHmq8RHmNXXweFYnKVbz4HrY7sx/Yuqp5iwUop2lmUYwqipqGyWA==,iv:I+7oRJ0dEGs8iNj7HBF3+SIcFa1Vk4EIwqNWv6ulVyg=,tag:EOYJu64ZuB5C32nBixL2eg==,type:str]
      privateKey: ENC[AES256_GCM,data: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,iv:Saz3giA4+5gxVuqSsEgiNPzrMO6ZnUxHKS7AXjkatoE=,tag:VUXjfjnJ8AFFbYIp5FcP0Q==,type:str]
      webhookSecret: ENC[AES256_GCM,data:4Ahlxvpn9BpkLh3LBer8YLhKFHGvuFWWZfCg0EA4d7VhUzvpUb3soOdMZXRxNV8e1Vnwa6QnAYEDC5d/N2VstQ==,iv:cfWTyXKKY4B4NX9zbgyChrNtJZjzYbNncriqGnfzfBk=,tag:DQ5UxbIyUBZjmnC7YKN8lg==,type:str]
    auth:
      register: false
    ingress:
      enabled: false
    filestore:
      backend: filesystem
      filesystem:
        persistence:
          enabled: true
          size: 5Gi
          accessMode: ReadWriteMany
          storageClass: longhorn
          persistentWorkers: true
    clickhouse:
      persistentVolumeClaim:
        enabled: true
        dataPersistentVolume:
          storage: 20Gi
          storageClassName: longhorn
          accessModes:
            - ReadWriteMany
            - ReadWriteOnce
    zookeeper:
      persistence:
        enabled: true
        size: 8Gi
        accessModes:
          - ReadWriteMany
          - ReadWriteOnce
        storageClass: longhorn
    redis:
      master:
        persistence:
          enabled: true
          size: 5Gi
          accessModes:
            - ReadWriteOnce
            - ReadWriteMany
          storageClass: longhorn
      replica:
        persistence:
          enabled: true
          size: 5Gi
          accessModes:
            - ReadWriteOnce
            - ReadWriteMany
          storageClass: longhorn
    postgresql:
      enabled: false
    externalPostgresql:
      port: 5432
      username: sentry
      password: ENC[AES256_GCM,data:2DX729Mm8hVxPH49TaqFt/3vt4KevMDXD20fZxqXFyBMSsrE/zyDMP0q8f788kWUSc2r8W9e2UcNUMtPyiWq3w==,iv:rKpdOtASqvhYCEO4ZUz3h65YEbRC/M51aaSLF9E0dMc=,tag:cXzzYUXF464LRLg54fdqig==,type:str]
      database: sentry
      connMaxAge: 600
      host: pg-cluster-v2-rw.postgres-cluster.svc.cluster.local
      sslMode: require
    rabbitmq:
      enabled: false
    kafka:
      controller:
        persistence:
          enabled: true
          size: 10Gi
          accessModes:
            - ReadWriteMany
            - ReadWriteOnce
          storageClass: longhorn
        logPersistence:
          enabled: false
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBOdEFKTno2L0RLZ3JBSjAv
        ZmpXZkVRVjZGaGJIOHRUbTAxSlZwYTdwUEZvCkdVN0pVMlBJZm1IVXlMZXBwZHRM
        RVJmL3lCa082V1gyZ0IvZTgrSHlveVUKLS0tIGl0R3pwK1NscVJHbFRWU2NWZU85
        UGl5SWY2MFczWk9jY1UwZlA2SXdPUnMK2nyCf4eTRQIAGvgb8nPC1EcrBfc3VuWJ
        eB8w4SzIqRE1paZRboSoGst1twIThhU9ieb5+crLuKgpIQql059/fA==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2025-12-16T09:22:01Z"
  mac: ENC[AES256_GCM,data:d+Z0pjuELzgk3ar8jA++9g5se3f6o7sfOUOopkKAWWNk8vWLKU0BymqyFIyY28S69YrezZbH/ic0bDypjukmQloWheDa5TTV/lWPxBQ6sng68TVsKW6f6dBfNxnMx0vmt3lWLSeD/pmEtiPgWLDsasIP4cNKExIl3emRDAKt4aw=,iv:lK8ZOcqRZxrm++CGR0fXdQBUoPmr+T/AxZNZi11dw2M=,tag:qKXtzLWbw3tnfabWqYtivw==,type:str]
  pgp: []
  encrypted_regex: ^(harborAdminPassword|totpVaultKey|kimaiAppSecret|kimaiAdminPassword|GITHUB_CLIENT_ID|GITHUB_CLIENT_SECRET|GITHUB_PRIVATE_KEY|woosh|root_password|rspamd_password|pgdb_password|matrix_access_token|pgdb_remote_url|hmac_secret_key|adminPassword|adminEmail|jenkinsAdminEmail|securityRealm|gerrit.config|routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword|adminPassword|adminUser|adminEmail|emailPassword|secretKey|appId|clientSecret|webhookSecret)$
  version: 3.9.1
