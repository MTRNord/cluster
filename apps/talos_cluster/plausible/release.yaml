apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: plausible
    namespace: blog
spec:
    chart:
        spec:
            chart: plausible-analytics
            sourceRef:
                kind: HelmRepository
                name: plausible
    interval: 60m
    timeout: 10m
    install:
        timeout: 10m
        remediation:
            retries: 3
    values:
        baseURL: https://plausible.midnightthoughts.space
        disableRegistration: true
        totpVaultKey: ENC[AES256_GCM,data:fdKmtI+7v7NjU+JhVdj+8FoL4htB0PDVwtpVbX4/gSXR4whU3NUV2I+EjCI=,iv:fE3spv2f3IfTviH41+0mlx1nQ5fUQoU73BB+bggGpqA=,tag:9XK4SY/DrdkWpzevVm+Rqg==,type:str]
        clickhouseDatabaseURL: ENC[AES256_GCM,data:L/MbZwzB5jMn/3Y3P9TPDr8Rez3QffCoCyra7G9D9dZw5U45tKJUi8QgfPMga2Nm/JsOtPXTKrjLwIwqDt0s3gJOVJkODfdHEPcbM33yIAVXVR2yjH7HKeSkkUGsI6o09sOZA35IQQ163jUPThm5ldY/kpAiL/WvYT8R9umnmDODpWyoi33XILT8Vnz8fHhlbXkm7Kpik5xoXqSR,iv:2Eo+LbkD9PyzBkeV/dDHxk6ADnnDJ+WXmNDa58NZ1vo=,tag:+Omq7CSPvm5tNKdOfqq5BQ==,type:str]
        databaseURL: ENC[AES256_GCM,data:1kzECfP0A8nMWE2/VtanqlMSHbgMolDK4yC7I2fnP/mYTN2sFuWfvEOsDTdJsAo5yloPsyfYa/xF5bnYmEKBtW8Biosb1m6hXXnnu5nPieOXID8M7rbeZv7Cw6tIk8iki1YgxXBk3MZxx8BqfGW2vGFnG4qvjoTyB3/Q8SjGCMNyuJ4YV7Cd0QnfEtmXqPB0U2MOC8YGVjs=,iv:7qNMpaubvQSFxkiS2bdSZrzu3GjddIeuegAgHXtrgAw=,tag:Bw+xkJm56HTrdYhUZ6ziPQ==,type:str]
        mailer:
            # TODO: Set up mailer
            enabled: false
        postgresql:
            enabled: false
        clickhouse:
            auth:
                password: ENC[AES256_GCM,data:qJLz7paIbYzCsscvTUp0TlcLJufsAMiLykyCmF4gvTLxFuL7D6beLHw5hf5L2+pXfx4AeYyRLCRQW9v5xFIB4A==,iv:Ytn85bq5aXppfavvgjx1qVIm522Io1LK9rXDd+8BQ7M=,tag:E/eNSfJ0EqUOwQatNvHr3g==,type:str]
            persistence:
                storageClass: longhorn
                enabled: true
                size: 8Gi
        ingress:
            enabled: false
            annotations:
                cert-manager.io/cluster-issuer: letsencrypt-dns
            hosts:
                - plausible.midnightthoughts.space
            path: /
            tls:
                - secretName: plausible.midnightthoughts.space-tls
                  hosts:
                    - plausible.midnightthoughts.space
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB1UHhIVlFkaTdxSjB0eUVF
            cmlBSjVPYWJoc2g4ODUyUTR5ZXpFbjVjZ0RRCk1LcDR1ZlBiNStPcU1wWndYR0J4
            ckF0eklIenJqUEpGMERpM2c3ZUJqU1UKLS0tIEQ0eEo2YlFXbkF6RmZydmRxbzhX
            SHFnZHhnQ3M5Yk44TE0xL1BXcE8vZGsKOgn5ADTYyfGXx2Ecg/mxBLtyetPylbz6
            vXCh/shcIF8tma5bOpYLDigbgYRkGWYmgPA7uZAKV1hezw0TpOyOYw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-10-16T20:21:33Z"
    mac: ENC[AES256_GCM,data:B3wh9jBOGkuCHY1xuZ88o0xpY2N3ZSeJFxWkS2XEwmuKD6MFi412euxe0k39ouN4GG8AcUyAP66jMkL+O+cTBJmnZYSdc6yKDL58Pvk1xfiPac1QJgrSspf7+vKp2lBNVUQY0d+QPGn+CE2QpZPfxGx4pUl+oeE48w/8KG0CbkQ=,iv:P8FZQmow4+MGyAPSPI3cw1zwOHjmvLmObvzZv38Qv/s=,tag:0UipqPUpEPGx3KL3RYeXFQ==,type:str]
    pgp: []
    encrypted_regex: ^(harborAdminPassword|totpVaultKey|kimaiAppSecret|kimaiAdminPassword|GITHUB_CLIENT_ID|GITHUB_CLIENT_SECRET|GITHUB_PRIVATE_KEY|woosh|root_password|rspamd_password|pgdb_password|matrix_access_token|pgdb_remote_url|hmac_secret_key|adminPassword|adminEmail|jenkinsAdminEmail|securityRealm|gerrit.config|routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.9.1
