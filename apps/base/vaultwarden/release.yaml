apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: vaultwarden
    namespace: vaultwarden
spec:
    releaseName: vaultwarden
    chart:
        spec:
            version: 0.31.8
            chart: vaultwarden
            sourceRef:
                kind: HelmRepository
                name: vaultwarden
    interval: 50m
    install:
        remediation:
            retries: 3
    values:
        pushNotifications:
            installationId:
                value: ENC[AES256_GCM,data:90q0/rq9oNjhnrfC46dkE1s0dm4fC8ytzVk7dJ2NvZOIB+Yp,iv:M2jKwha1LsNejXV+wV23mxjRnC78+iZxqrUzQEBvZqU=,tag:tuwMAAFJygjjP9Pv9UBBPA==,type:str]
            installationKey:
                value: ENC[AES256_GCM,data:XkRoSWns4V24JuJ2hp32/H+/C9A=,iv:djW85nhw1pZIPsBUwSj3iLTjHFt3oHCu1wdsGSa7xVM=,tag:zsrWvcuR6uvB6NlyaeB+cA==,type:str]
            relayUri: https://push.bitwarden.eu
            identityUri: https://identity.bitwarden.eu
        signupsAllowed: false
        domain: https://vault.midnightthoughts.space
        signupDomains: nordgedanken.dev,gmail.com
        timeZone: Europe/Berlin
        database:
            type: postgresql
            uriOverride: ENC[AES256_GCM,data:KsSph5QMyibBEDrKh/KLL2e9fZrAIbeRGRzOQ4Ejv5cn9TJqSAlqo+XBdfkW2tP9hDlZ9no45N1FU0dew+U0C8YtXdvYK7OECFUsd7ur/moPFNq5R4qxM6JRv1ftjJ5kl+jeT4THWxCFCfdahSpQrM6WIfwv3kXG+iWAcndXls4b5eY1/ldNBm0/h9R72AcqBtuK43EMTmulHafWoME=,iv:5PT1Uw3g0IDXn/SEiaEkV/Zgx3q/J/jhhXBk36wuVfk=,tag:zWQMxqZgblFVQKrZqTlcPw==,type:str]
        ingress:
            enabled: true
            additionalAnnotations:
                external-dns.alpha.kubernetes.io/hostname: vault.midnightthoughts.space
                cert-manager.io/cluster-issuer: letsencrypt-dns
            tlsSecret: vault.midnightthoughts.space-crt
            hostname: vault.midnightthoughts.space
            nginxIngressAnnotations: false
            class: traefik
        adminToken:
            value: $argon2id$v=19$m=19456,t=2,p=1$R0VoUlJ2T3I5UDRiL0h0cGgvTzYwbHhIL0poeFNpWmkzZThPUDh3TnNtND0$dm7crNLYaQFcGS7KZ38aKTyrV+E2RdyYKx1wDSjpu4s
        smtp:
            host: smtps-proxy.fastmail.com
            from: vault@nordgedanken.dev
            fromName: Vault Administrator
            username:
                value: mtrnord@nordgedanken.dev
            password:
                value: ENC[AES256_GCM,data:LnAnbwKLoQIydlbCfqE5aA==,iv:kny1c6HHze2MMX9IoHQQqlIy83Nqtu9Mtm/vxQ/Nry4=,tag:18uCfkzaZ8T0e1Xf5T/xOA==,type:str]
            security: force_tls
            port: 465
        data:
            name: ENC[AES256_GCM,data:2LFgzVRBOBPtDbtW0mAwCg==,iv:3rGjETWrO3WyxBl7KWxyTWpTbh76p/Thed7Nsjr1UKs=,tag:K1TXv+SRhhYdvYensIwLDg==,type:str]
            size: ENC[AES256_GCM,data:LVtE,iv:8HP4cDF3uq/cVrI42qjYw1n8UQOouNo3jVDjG2a1bxQ=,tag:CiK6R4NLwoOb847XW8Hr1Q==,type:str]
            accessMode: ENC[AES256_GCM,data:C5Oz5DRNFp9jL2RI/Q==,iv:yaR4C6gVCsg1aasKgza/5w+h3Q7LbGNsmC5W1KJBVjg=,tag:AVKpWmfLw8yhKuTfUdDdlA==,type:str]
            keepPvc: ENC[AES256_GCM,data:9c9E0g==,iv:JpZclPNMkcN9AvQZJvLQ/NebZfuDpNTx4OmNYPl/Pec=,tag:Za1Q60umVOdcK4LRgNmPdg==,type:bool]
        resources:
            requests:
                cpu: 50m
                memory: 256Mi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB6WURTRzk5WTdYTk1xSzFP
            VFBsZUZNcWtRTk10MnloZkFpb1F0ODkrTkhjCmRMNjNqa0lpV3dzeEJSd3pOdUth
            SzBucWEzSTkybDJaZXB6ZFNBYlJKTXcKLS0tIDByajI3ajRySVpHK3RzajQ4QkNt
            SDJHZEkvRlFmYjVlWE1LWXdsblNRSm8K2Q8x98IadrNo/J7nsckKl1+AOUAVbLDl
            +6M8Qru1jmDxdeIgh0Sl449hd+t2+IHgd0m5U7Cy+PfX5FRlv1syUA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-03-16T12:06:07Z"
    mac: ENC[AES256_GCM,data:ftobFwWPQqQ/7p+cBBmFJAJFTnAXQUJZ8M/03qKWxdRkgumBHgvIFT3j3QuEGCmro8PqyKM/hEzYja93zWdiLvEu6LjULoazwHZgl4B9bezkrMh7lHmi+85JcHMYwTDzozR2EYjZRtPmwk5U8cshFNZZ51y2noqRGJo8Q0eftRc=,iv:P5K0PWZRhowidPOTe2VRqKfENwdMVTUS3xcz8lfdZo4=,tag:mNyTrFBOReGNuCW+dwPL0Q==,type:str]
    pgp: []
    encrypted_regex: ^(adminPassword|adminEmail|jenkinsAdminEmail|securityRealm|gerrit.config|routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.9.1
