apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: plausible
    namespace: plausible
spec:
    chart:
        spec:
            chart: plausible-analytics
            sourceRef:
                kind: HelmRepository
                name: plausible
    interval: 60m
    timeout: 10m
    install:
        timeout: 10m
        remediation:
            retries: 3
    values:
        baseURL: https://plausible.midnightthoughts.space
        disableRegistration: false
        clickhouseDatabaseURL: ENC[AES256_GCM,data:2Eo5AtJ7+dMdFjk7BuOtQA0mfUIWciQiVUq1bz0ARml8SahzU+uO+9IoI+x8oAJgmePmml3pNMxlqVSaPEe/HXhmD8MljDC6mCclC3Hf5iEDrros6JTY/Y8g77Hq/Pc4UFmZ/A+rSsGU9UZO6ADnB9ept8YJHkNRPVi5AoBR99ioaky228l/Sg36zJzDLwF8hvbaRvxVcZ8ibu3B,iv:h+e1sfRiZcN8HHKPq7th6P0O5A3dZQ8jzzelOgCz+k0=,tag:zv8eatVuf4QL+xebL3YqDg==,type:str]
        databaseURL: ENC[AES256_GCM,data:xSyXznMep1pErASA787LMXthxZvjV9odKW8zK3PDn7NrhfgoyDnU4RDkKoQeiN7jkEGtA1FH8NM2SATBndDsHP64xwdvVQtvUwpa5s8xZjC6rvbA83SKNJicicKOi6nNjol9mBvaNleCiPtxbtX1YXXqNDF+mLzvUfmOdUERffAqvcsPZ5UW2trfE2045eXfZLm7koEufJgj8Zn4ifPdKA8NTaqVNVws,iv:6zEfeMnzcz32/tKDzLgtlBKf+gj8LRJmaySTxJfjfuo=,tag:OUMbweRuCPMjefcGHHMFXg==,type:str]
        mailer:
            # TODO: Set up mailer
            enabled: false
        postgresql:
            enabled: false
        clickhouse:
            auth:
                password: ENC[AES256_GCM,data:cDlPOj1QihqqwVdChWdGb1RfbBnw4gbM7EMJ6mlhGDr2NQTEn1vqTF6VWfJY+pScNIyzRWiJrtrPz76xwE+Bkw==,iv:+DSPzu17lFfGfb4+ZP9dRH3oIzN+6Sm5Upah/4lc6/Q=,tag:nCXAuTeMCTllttJkt9ZHBw==,type:str]
            persistence:
                enabled: true
                size: 8Gi
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: letsencrypt-dns
            hosts:
                - plausible.midnightthoughts.space
            path: /
            tls:
                - secretName: plausible.midnightthoughts.space-tls
                  hosts:
                    - plausible.midnightthoughts.space
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSAwZitWVGo0czk5VWp0dUEw
            RUpJRktJbjN6YjU4ajFZbTJ0aHpLdUZnd0c4CnFkS2VVdjdhTkdoMkdQYnkzTE9N
            Z1pZYVg2bkdxcWtiTTB4WC8vdkZzdUEKLS0tIDl1Z25ERHE0dTZKTXdEM2lYQ3I5
            dGhMSXRlV1NWa0tDR0phbTFuU3B3T2sK9WNo2RM4oA9CBOiKg2lAQ26lrHRnGg0E
            HN02AFlsapcZj9Ze3XkXo05mAszPE/rTzgfz5nOikTd++4wOHRnyMA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-06-10T17:21:55Z"
    mac: ENC[AES256_GCM,data:5yWO0dLLYiaqIaHcKsfdZ+ItyoNh3Q5DVf+bx1z3xXHVzR6IA3VJH3L20KuNMhMTTYyp0npju/X6jQAdBCJ05XBoxKNJXrP9VS3VDszuDEecn6WgctDV8R+LqxU15xbQ+mB4ggREbgyyXvrJainWcnS8z2tQO+Tzi2wuW7Ulpho=,iv://Burr9iKH2RZrZzlwGyLRVRZnjea/LplLLAFdxncM0=,tag:6mX+Cw7Cj/VlRvcTn26FgA==,type:str]
    pgp: []
    encrypted_regex: ^(clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|PASSWD|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|adminPassword|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret)$
    version: 3.8.1
