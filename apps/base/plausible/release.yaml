apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: plausible
    namespace: plausible
spec:
    chart:
        spec:
            chart: plausible-analytics
            sourceRef:
                kind: HelmRepository
                name: plausible
    interval: 60m
    timeout: 10m
    install:
        timeout: 10m
        remediation:
            retries: 3
    values:
        baseURL: https://plausible.midnightthoughts.space
        disableRegistration: false
        clickhouseDatabaseURL: ENC[AES256_GCM,data:SrIVmyFX+SsouvBT7rtoMnTeoXeBwpj26VwPOGY+TOtjO71JU6hrWjv0tyN1b16DNStOYdvrTjxNIUZEXG8h5w8NlT7XoMeAZaAR0dcdgXqwEbOP827cDQptfpB5rnt5WgzoXXXNH+MGabAnDRBvqX+ZWW22+Y2/RE9gnKKHpnlEJGvFgAFcQ16Bt/gWZ8us+AUlHIZcloseUYIW,iv:PCp0cPy/2blRrvJVyvFQUI/cipLzaVia1WexmRSln5A=,tag:lRhbyfl3yROKMsJFY5ES9A==,type:str]
        databaseURL: ENC[AES256_GCM,data:9gZ3UxWSAf5I3awyMaMMb9qWSYRQPGtpb+kKYZ648ytqXil2wAhEGZIuG5XOqZlKRdiVNHJ21YerZ2gmvEELdlKIN/5bFJ/83jy4guNKsC65GKIwp7HksxeMDAmBDLAD6WFa3kk7H0PWzwOLYPQrTdRdZ8+gOY44V73JvLZVzUYF01QQ2lwkIBZGN/b6/KZInLFio0tiPRs=,iv:/vvN9pPF0GX3dLzlZSYZF/NLW5ylOOj3yLT3F7/ueuM=,tag:SikGmzxp0k7MRQq6gw6K+w==,type:str]
        mailer:
            # TODO: Set up mailer
            enabled: false
        postgresql:
            enabled: false
        clickhouse:
            auth:
                password: ENC[AES256_GCM,data:ItS/u9kuZs8lXgQ+r4qX7XXbhDvTzp1utPnXNL5niJpuTOiN13n+xOEK4L5UNpz0nuPlaZjZwz3uvjTgQhCBTw==,iv:jVKcrQlaSpklefiW4NUObdFPtWlDM99XsjDgZydWR8Y=,tag:MJ0NokLHwjEw/pgYPwXfIQ==,type:str]
            persistence:
                enabled: true
                size: 8Gi
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: letsencrypt-dns
            hosts:
                - plausible.midnightthoughts.space
            path: /
            tls:
                - secretName: plausible.midnightthoughts.space-tls
                  hosts:
                    - plausible.midnightthoughts.space
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBjcTRMVVlvcnhsUE9NZHBR
            Qkt3Unc2UnFjZVVhUW1WMkpxNzBkb1BldlVRCjY4L0ZSS3EycWhHU1FMVjA1VXFi
            bGROdDJvMGwrWEQ3cWVJaU5waXNuOVkKLS0tIHJXVEd6VndIUzVnRUl5UTZtaEZk
            NllZSEcxRllrKzI0NTlJQzdFdGFBZmsKFnEZNjuFNCzeQq41K4RDEUdteNEEp7uQ
            prFzS3Wcqo4BF8Ophl3KBVAhdbI21mH637jaMN7szmqifSgZrc63TQ==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-06-10T16:59:36Z"
    mac: ENC[AES256_GCM,data:aSt1YHkSh5DWCYinTsuezzJKXUKLt74ZjSZaz0/9FJgZYWr2+aXFWG6diILxs4RocTsd4iFP3sISoWt+Y0YGoEGnT8cx0+pVVxq2caSwe0gklC7yMW7ve8Al3ALwJcHZLS/4idGjPuyfCXeygqZztSZQuZatGhJ7ZUd5vRi7Aic=,iv:XnJ38n2oA/ai+798q4Lmvc0MjANAepGxDvhsH6ky4qA=,tag:v25CW039iYlWFYHDPDclHw==,type:str]
    pgp: []
    encrypted_regex: ^(clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|PASSWD|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|adminPassword|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret)$
    version: 3.8.1
