apiVersion: v1
kind: Secret
metadata:
    name: miro-neoboard-exporter-secret
    namespace: neoboard
type: Opaque
stringData:
    MIRO_CLIENT_ID: ENC[AES256_GCM,data:Zd5uCtM45F7swDwlGrMXt3UDbw==,iv:9WgRGtvLLLcnA+LzI2iydVgxcWmQmTDR9Mw7QxLk8P8=,tag:VokauHdhjLfVXV5W+iafAA==,type:str]
    MIRO_CLIENT_SECRET: ENC[AES256_GCM,data:pufIfi/TO+YTQzJ9L5FPqMWYeQE9vrHRAxaJ/6CCJ+4=,iv:5iWir6LRAdcfJC8eDWjMWSMK/9GpENnldr+NVWEnzWM=,tag:bYcSUaf3BRGuIoLlysDbSA==,type:str]
    MIRO_REDIRECT_URL: ENC[AES256_GCM,data:NSePoGjCZSUO9xY597v4HS9oz+z8zR7MMk9SEupbhd5silY+NZuvXyu2CZ+5JUBQ4ojdCBTuy3+4FPE4FiOSog==,iv:DAHq/jdEyxTZGYnVBmg63WWOGIlRFoBNW3KR51OAKog=,tag:kLGjIaz0wrcMSZRiev9Fsg==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBiSjJRVVZkb255b05TcHEx
            ZmVSR0pFakV5ZHVEek5RRjlsZEJwSThwSEI0Cmw2OWNwOXFNN0VBa0lsMHhaWWxI
            SXFvak5OamhBR2ZUVG5KUy9LUlJyUkEKLS0tIG1HTmJDbXZUaGd0MzNXeEQyTWtC
            aUk4SjBtc2hybHNUeHFkSlRaRmpkeDAKpp74tQsnwAvvoVrjKWYYJ13AQPBVVgxZ
            DSamCNCzjC91WfzPXbl85xE7+Gvw0m6RV+heRtTyR4Y0G0G036iycw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-01-13T14:27:55Z"
    mac: ENC[AES256_GCM,data:E4JXEvXhusy0B4VRIzvAgJI6w1GnfpKHe88ImbcBuaQf8Qdf25PXnmYy3g2rjxatOc++mikbhL8hP6TsPFX8eO4GQctSVYCBPuhEiQlINu6gwY35nK47SbX9qqGgwg9a+b7uPT/Ty++JCS14sNEPuP/TioHnhPk61kji0Ec2u4Q=,iv:skauqT0UHaUv13kpG17Iw295G6JRxPCTq6BJIa6s5CM=,tag:WLuGfonef5vJhRsmTzheww==,type:str]
    pgp: []
    encrypted_regex: ^(adminPassword|adminEmail|jenkinsAdminEmail|securityRealm|gerrit.config|routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.9.1
---
apiVersion: apps/v1
kind: Deployment
metadata:
    name: miro-neoboard-exporter
    namespace: neoboard
spec:
    replicas: 1
    selector:
        matchLabels:
            app: miro-neoboard-exporter
    template:
        metadata:
            labels:
                app: miro-neoboard-exporter
        spec:
            containers:
                - name: miro-neoboard-exporter
                  image: ghcr.io/mtrnord/neoboard-exporter:latest
                  pullPolicy: Always
                  ports:
                    - containerPort: 3000
                  envFrom:
                    - secretRef:
                        name: miro-neoboard-exporter-secret
                  volumeMounts:
                    - name: env-file
                      mountPath: /app/.env
                      subPath: .env
            volumes:
                - name: env-file
                  secret:
                    secretName: ENC[AES256_GCM,data:1Ev9Zws68EjBGh/OaiA/YzC7N03E3qn5j9bu61o=,iv:Aok+HTlV8gE4w9R3yiIhcW1elTjCvRbOJmDDqnVAFC4=,tag:7wo7Z7vxDRJW3/muWvNntQ==,type:str]
                    items:
                        - key: ENC[AES256_GCM,data:/9wQ653epNNyHPqavVY=,iv:M2WzdLNVNZ5rgyQcV4rBKeCepPrQsekU/RpNPZahJDk=,tag:CkjUSQGCNs3ddKRu2pnlHg==,type:str]
                          path: ENC[AES256_GCM,data:1Miqpw==,iv:kTLZNT9ssxROzhCQ7DioTKV+UqCwuPDFEKn01jmC9+E=,tag:dks8yU7BsbRf/VPEr4zLlg==,type:str]
                        - key: ENC[AES256_GCM,data:xwEYHA4mWQaotf3jUDk/NuaT,iv:JRZEbHJjwMZc7FF9FDNHeDJdwyaF5N6HIl3P1KarjFo=,tag:0ZB05j9i6EbG0YclwaNRJg==,type:str]
                          path: ENC[AES256_GCM,data:aluZPA==,iv:Q4f59DUCdCyJQKtwVM6ek1W2R7Hjw4K87grb16xLAdM=,tag:+lbe6HPW+X81h++2/PpYqA==,type:str]
                        - key: ENC[AES256_GCM,data:7rmO4DPyx1VYrJHQA+ys2kM=,iv:CpP9SO0ifuQaGb0O412KxK7sV7Ns/pszk/knolRxaik=,tag:zpcsol8OLhwacG2BcYi3tQ==,type:str]
                          path: ENC[AES256_GCM,data:KMiPCw==,iv:QTkOb/mZtYB3h9ldv8YXsnR8ihuLjk2Gt5KKnf+x7Ig=,tag:NrG5zDIRoJOntQScgxu78Q==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBiSjJRVVZkb255b05TcHEx
            ZmVSR0pFakV5ZHVEek5RRjlsZEJwSThwSEI0Cmw2OWNwOXFNN0VBa0lsMHhaWWxI
            SXFvak5OamhBR2ZUVG5KUy9LUlJyUkEKLS0tIG1HTmJDbXZUaGd0MzNXeEQyTWtC
            aUk4SjBtc2hybHNUeHFkSlRaRmpkeDAKpp74tQsnwAvvoVrjKWYYJ13AQPBVVgxZ
            DSamCNCzjC91WfzPXbl85xE7+Gvw0m6RV+heRtTyR4Y0G0G036iycw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-01-13T14:27:55Z"
    mac: ENC[AES256_GCM,data:E4JXEvXhusy0B4VRIzvAgJI6w1GnfpKHe88ImbcBuaQf8Qdf25PXnmYy3g2rjxatOc++mikbhL8hP6TsPFX8eO4GQctSVYCBPuhEiQlINu6gwY35nK47SbX9qqGgwg9a+b7uPT/Ty++JCS14sNEPuP/TioHnhPk61kji0Ec2u4Q=,iv:skauqT0UHaUv13kpG17Iw295G6JRxPCTq6BJIa6s5CM=,tag:WLuGfonef5vJhRsmTzheww==,type:str]
    pgp: []
    encrypted_regex: ^(adminPassword|adminEmail|jenkinsAdminEmail|securityRealm|gerrit.config|routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.9.1
---
apiVersion: v1
kind: Service
metadata:
    name: miro-neoboard-exporter-service
spec:
    selector:
        app: miro-neoboard-exporter
    ports:
        - protocol: TCP
          port: 80
          targetPort: 3000
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBiSjJRVVZkb255b05TcHEx
            ZmVSR0pFakV5ZHVEek5RRjlsZEJwSThwSEI0Cmw2OWNwOXFNN0VBa0lsMHhaWWxI
            SXFvak5OamhBR2ZUVG5KUy9LUlJyUkEKLS0tIG1HTmJDbXZUaGd0MzNXeEQyTWtC
            aUk4SjBtc2hybHNUeHFkSlRaRmpkeDAKpp74tQsnwAvvoVrjKWYYJ13AQPBVVgxZ
            DSamCNCzjC91WfzPXbl85xE7+Gvw0m6RV+heRtTyR4Y0G0G036iycw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-01-13T14:27:55Z"
    mac: ENC[AES256_GCM,data:E4JXEvXhusy0B4VRIzvAgJI6w1GnfpKHe88ImbcBuaQf8Qdf25PXnmYy3g2rjxatOc++mikbhL8hP6TsPFX8eO4GQctSVYCBPuhEiQlINu6gwY35nK47SbX9qqGgwg9a+b7uPT/Ty++JCS14sNEPuP/TioHnhPk61kji0Ec2u4Q=,iv:skauqT0UHaUv13kpG17Iw295G6JRxPCTq6BJIa6s5CM=,tag:WLuGfonef5vJhRsmTzheww==,type:str]
    pgp: []
    encrypted_regex: ^(adminPassword|adminEmail|jenkinsAdminEmail|securityRealm|gerrit.config|routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.9.1
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
    name: miro-neoboard-exporter-ingress
    annotations:
        cert-manager.io/cluster-issuer: letsencrypt-dns
        external-dns.alpha.kubernetes.io/hostname: midnightthoughts.space
spec:
    rules:
        - host: miro-export.neoboard.midnightthoughts.space
          http:
            paths:
                - path: /
                  pathType: Prefix
                  backend:
                    service:
                        name: miro-neoboard-exporter-service
                        port:
                            number: 80
    tls:
        - hosts:
            - miro-export.neoboard.midnightthoughts.space
          secretName: miro-export-neoboard-ingress-tls
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBiSjJRVVZkb255b05TcHEx
            ZmVSR0pFakV5ZHVEek5RRjlsZEJwSThwSEI0Cmw2OWNwOXFNN0VBa0lsMHhaWWxI
            SXFvak5OamhBR2ZUVG5KUy9LUlJyUkEKLS0tIG1HTmJDbXZUaGd0MzNXeEQyTWtC
            aUk4SjBtc2hybHNUeHFkSlRaRmpkeDAKpp74tQsnwAvvoVrjKWYYJ13AQPBVVgxZ
            DSamCNCzjC91WfzPXbl85xE7+Gvw0m6RV+heRtTyR4Y0G0G036iycw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-01-13T14:27:55Z"
    mac: ENC[AES256_GCM,data:E4JXEvXhusy0B4VRIzvAgJI6w1GnfpKHe88ImbcBuaQf8Qdf25PXnmYy3g2rjxatOc++mikbhL8hP6TsPFX8eO4GQctSVYCBPuhEiQlINu6gwY35nK47SbX9qqGgwg9a+b7uPT/Ty++JCS14sNEPuP/TioHnhPk61kji0Ec2u4Q=,iv:skauqT0UHaUv13kpG17Iw295G6JRxPCTq6BJIa6s5CM=,tag:WLuGfonef5vJhRsmTzheww==,type:str]
    pgp: []
    encrypted_regex: ^(adminPassword|adminEmail|jenkinsAdminEmail|securityRealm|gerrit.config|routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.9.1
