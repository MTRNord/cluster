apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
    name: plane
    namespace: plane
spec:
    releaseName: plane
    chart:
        spec:
            chart: plane-ce
            version: 1.1.0
            sourceRef:
                kind: HelmRepository
                name: plane
    interval: 60m
    values:
        ingress:
            enabled: false
        rabbitmq:
            storageClass: ceph-filesystem
        minio:
            storageClass: ceph-filesystem
            root_password: ENC[AES256_GCM,data:A4eFAiWD8aje714UmWbwtlXktMAnhUCqRldA4iK+JTLMrBnTLSJdrzKtDldVBWxaAAGYDtctWR+1zhfwJiaWQg==,iv:plRCByOuvdbo+rSafzxCg7cU2+9oO6WU86v8nYa+u5c=,tag:8ML7ZBoV0Z7Qz7zcGOOBQQ==,type:str]
        redis:
            storageClass: ceph-filesystem
        postgres:
            local_setup: false
        env:
            storageClass: ceph-filesystem
            pgdb_username: plane
            pgdb_password: ENC[AES256_GCM,data:3T0QbTsA+yrugBV9Xshhrdq6h4flMoYp4h/1URnrjZQahd4qm3MUhZOKg4SC4kszp9TR+DachUZW6iKjfIz70w==,iv:ZuArXaMeFYRxTAYIx2FLEJdj3tLWUjObSzUzYgDtPLw=,tag:gcwJ1QRxs93XX+7RD10CTw==,type:str]
            pgdb_name: plane
            pgdb_remote_url: ENC[AES256_GCM,data:tt9+M2EK7aYXwZ3IV0DG4CiJbm0hRVbNsWqTnDMiyftxICG9p2BfXopPqznFjytn6SBA4X8nNTM8ZmLgYgjYXUGh9mAyBTRFyW6VywrxT//WDgSVd+2y2plsSZdEiJd3Am1JVUmmr8gWEmEmBmDUfPVApyyx9sziO/rkCPBa2rWpQ4UYpYwGFk3qq20S,iv:P3rt75mQNVDEGmjyeAOEz6dcxcHl6Lj7xFnYxS6HgHU=,tag:N6EaVvBSAlhTT9W5QPprPA==,type:str]
            secret_key: ENC[AES256_GCM,data:hEQ0Z3DsDXpFJqZ1fAsDRP+lWnamQeC+r4rJbkZaxPx0Kc6L9tZpjXEMdYAaRufA0Gppp9gLKn/6aqSbXmNLhw==,iv:qQJhJIO13Vm2Cfh3mUOHaq9WNnJf4XMi6uw4hAOW2hU=,tag:ZUHKsVYOu2mbz2OdmhcHhA==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB5T1lWWjVjb1c0VWp1WUxI
            Vi9WVkhwa3MwQmdIeFdRVDRTSzZGOFZVNEFvCm5Na0ZBcHJqUXpKeDlJUGJEMUhZ
            cUdDVlo5K2p5QTdyMmRwTEhOSXphT1kKLS0tIDBNRlg3Y0IxT2p4ZlVhQVoxZXMz
            OFU1Rll4WmFBM1RlYlFZWkdsQWEza28KHsw4xjAOY/CnlRnsen2V8zvwAFicp4jp
            Znp2qpWmBT1zBNqPnDE27Tu494zM/TeJH7PjDHathLdnuFtwfdK7jw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-04-04T13:54:00Z"
    mac: ENC[AES256_GCM,data:uCb4TPEvZBuonsiyGwFWiaquabNFEpveaAHsh/SD+Egvcud1Iy9jBXGYO9OZr/vDdaOmZ71hoS17otiXJDLqxyozKLi8Eulp84ebYzAJ+hTlOdqdSPXudHcZZXkRu3qoKfHt5LHH0Bx8cPaQ06dYYakMQ7u/jAr8Kh6Mtw4UBvc=,iv:Qls3ruVwMzpU1sLaO4taGvKuP7lBakBXRC8Y4AOCF54=,tag:sPeLtr2NVdUHY3EhJXG8Qw==,type:str]
    pgp: []
    encrypted_regex: ^(root_password|pgdb_password|pgdb_remote_url|adminPassword|adminEmail|jenkinsAdminEmail|securityRealm|gerrit.config|routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.9.1
---
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
    name: plane
    namespace: plane
spec:
    parentRefs:
        - name: envoy-gateway
          namespace: envoy-gateway
    hostnames:
        - plane.midnightthoughts.space
    rules:
        - backendRefs:
            - name: plane-web
              port: 3000
          matches:
            - path:
                type: PathPrefix
                value: /
        - backendRefs:
            - name: plane-api
              port: 8000
          matches:
            - path:
                type: PathPrefix
                value: /api
        - backendRefs:
            - name: plane-api
              port: 8000
          matches:
            - path:
                type: PathPrefix
                value: /auth
        - backendRefs:
            - name: plane-live
              port: 3000
          matches:
            - path:
                type: PathPrefix
                value: /live
        - backendRefs:
            - name: plane-space
              port: 3000
          matches:
            - path:
                type: PathPrefix
                value: /spaces
        - backendRefs:
            - name: plane-admin
              port: 3000
          matches:
            - path:
                type: PathPrefix
                value: /god-mode
        - backendRefs:
            - name: plane-minio
              port: 9000
          matches:
            - path:
                type: PathPrefix
                value: /uploads
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB5T1lWWjVjb1c0VWp1WUxI
            Vi9WVkhwa3MwQmdIeFdRVDRTSzZGOFZVNEFvCm5Na0ZBcHJqUXpKeDlJUGJEMUhZ
            cUdDVlo5K2p5QTdyMmRwTEhOSXphT1kKLS0tIDBNRlg3Y0IxT2p4ZlVhQVoxZXMz
            OFU1Rll4WmFBM1RlYlFZWkdsQWEza28KHsw4xjAOY/CnlRnsen2V8zvwAFicp4jp
            Znp2qpWmBT1zBNqPnDE27Tu494zM/TeJH7PjDHathLdnuFtwfdK7jw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-04-04T13:54:00Z"
    mac: ENC[AES256_GCM,data:uCb4TPEvZBuonsiyGwFWiaquabNFEpveaAHsh/SD+Egvcud1Iy9jBXGYO9OZr/vDdaOmZ71hoS17otiXJDLqxyozKLi8Eulp84ebYzAJ+hTlOdqdSPXudHcZZXkRu3qoKfHt5LHH0Bx8cPaQ06dYYakMQ7u/jAr8Kh6Mtw4UBvc=,iv:Qls3ruVwMzpU1sLaO4taGvKuP7lBakBXRC8Y4AOCF54=,tag:sPeLtr2NVdUHY3EhJXG8Qw==,type:str]
    pgp: []
    encrypted_regex: ^(root_password|pgdb_password|pgdb_remote_url|adminPassword|adminEmail|jenkinsAdminEmail|securityRealm|gerrit.config|routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.9.1
