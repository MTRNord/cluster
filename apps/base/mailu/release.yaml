apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: mailu
  namespace: mailu
spec:
  releaseName: mailu
  chart:
    spec:
      chart: mailu
      sourceRef:
        kind: HelmRepository
        name: mailu
  interval: 50m
  timeout: 25m
  install:
    timeout: 25m
    remediation:
      retries: 3
  values:
    domain: "nordgedanken.dev"
    hostnames:
      - "nordgedanken.dev"
      - "mta-sts.nordgedanken.dev"
      - "miki.community"
    timezone: "Europe/Berlin"
    subnet: 10.244.0.0/16
    subnet6: fc00:0::/96
    postgresql:
      enabled: true
      primary:
        tolerations:
          - key: "arch"
            operator: "Equal"
            value: "arm64"
            effect: "NoSchedule"
        persistence:
          subPath: "/postgresql"
          existingClaim: mailu-storage
    persistence:
      single_pvc: true
      storageClass: "rook-main-fs"
      accessModes:
        - ReadWriteMany
      size: 15Gi
      claimNameOverride: mailu-storage
    ingress:
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-dns
    front:
      hostPort:
        enabled: false
      externalService:
        enabled: false
        ports:
          pop3s: false
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"
    redis:
      master:
        persistence:
          subPath: "/redis"
          existingClaim: mailu-storage
    admin:
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"
    postfix:
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"
    dovecot:
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"
    rspamd:
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"
    clamav:
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"
    webmail:
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"
    radicale:
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"
    fetchmail:
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"
    oletools:
      tolerations:
        - key: "arch"
          operator: "Equal"
          value: "arm64"
          effect: "NoSchedule"





