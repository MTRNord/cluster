apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: piwigo
    namespace: piwigo
spec:
    releaseName: piwigo
    chart:
        spec:
            version: 9.0.5
            chart: piwigo
            sourceRef:
                kind: HelmRepository
                name: piwigo
    interval: 50m
    timeout: 25m
    install:
        timeout: 25m
        remediation:
            retries: 3
    values:
        podOptions:
            nodeSelector: {}
            tolerations:
                - key: arch
                  operator: Equal
                  value: arm64
                  effect: NoSchedule
        piwigo:
            language: en_US
            admin_user: admin
            admin_pass: ENC[AES256_GCM,data:7sfXI1B+p548,iv:Sb7xLV8ysnifUsScOomT7wKWjCXrP10/GZC/ZLEjEWA=,tag:2sm0OITWluSlGdhsYsAwlw==,type:str]
            admin_email: ENC[AES256_GCM,data:HmptPEZ30l+qzXT3/BOtXaU+y1GY+TED,iv:V6CL65Yhl6X5iPhLOUgFX0xAJ565MO1WShGCCHb6Zk8=,tag:EYqdWp39ZIsF1aWZoMkrsQ==,type:str]
        persistence:
            config:
                enabled: true
                type: pvc
                mountPath: /config
                size: 2Gi
                storageClass: nfs-csi
            gallery:
                enabled: true
                type: pvc
                mountPath: /gallery
                size: 25Gi
                storageClass: nfs-csi
        mariadb:
            enabled: true
            mariadbUsername: piwigo
            mariadbDatabase: piwigo
            mariadbRootPassword: ENC[AES256_GCM,data:qTlZXGCfg4VLI4UUVXjzHcvGlZoPkU5H+d1uDdKuBCRfKMyT/6VRLzJqblFi664u3r0nyzALl+8CyBGbBp/yDA==,iv:HCzPA8uNXraevSXDbUSqUPK3MlNiSXybMe9GDatNjc8=,tag:1I5UXQ72e4n62Mug168F5w==,type:str]
            mariadbPassword: ENC[AES256_GCM,data:1dQ0bYF7yztBUKIJL4rdIazbtaG6VAavdOyr0Ep7VHvYHVVQfLRtlyFs4xEEHCt2Cqmft8nJ1qCTTF+LrlXLZw==,iv:Q1Uexss8Z4pbF7JTOFswCTtllJErY6x7/WNo6GUz2Tg=,tag:r59upcezbOSZ1Qb3N9GhKA==,type:str]
        ingress:
            main:
                enabled: true
                hosts:
                    - host: piwigo.nordgedanken.dev
                      paths:
                        - path: /
                          pathType: Prefix
                tls:
                    - secretName: piwigo.nordgedanken.dev-tls
                      hosts:
                        - piwigo.nordgedanken.dev
                integrations:
                    certManager:
                        enabled: true
                        certificateIssuer: letsencrypt-http
                    traefik:
                        enabled: false
        operator:
            verify:
                enabled: false
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSAxeERzNUJ2eklEZ2R3Q1lJ
            ajMxNkVIK1dxdENKMExUMWRHcWorZFBzbTJjCnQyR1AwT3JXU1RmS24xUUlaTXAz
            TkpIcC9UZmQ3aVJJUDlwckpDVjdEdVUKLS0tIEl1VHQxZUFuTVMzRWJ0MDRCT2hq
            Y0txUXRNdjZsQkhzZDNVeHRtVWJZYzgKvHIrHoZAN/XIR66F8WUvTxwF7f5RizxI
            1M5Zy5N5zfR4GlGPpD+uXymzUJv6SkVfOEAtobCrWc5mhcCeCo+NLA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-12-31T00:30:24Z"
    mac: ENC[AES256_GCM,data:sQFjmFdjxs9eVeM50zVf+wTRnOcgs71ip3kysx2mxcgk80YeoJqtLk/XVkaQmQRgfRmiDRObKdKvwF00Z5I80Qj3Lx6yvn0fEQ+K6V4pPzzW2rFE5Se7bAUNbE6SFt/1mlY3XHP1a+ZZDJ3uxwbtxd+DjAI26/GTlUdkp9IdpGw=,iv:NB6wv9WlpkUPhcHSabmeiVjl9GUBbCqx7ynlc48mgpI=,tag:6k3KtnpHifbCDQE+DUhXhw==,type:str]
    pgp: []
    encrypted_regex: ^(admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret)$
    version: 3.8.1
