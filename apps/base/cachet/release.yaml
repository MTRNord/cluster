apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: cachet
    namespace: cachet
spec:
    releaseName: cachet
    interval: 60m
    chart:
        spec:
            chart: cachet
            sourceRef:
                kind: HelmRepository
                name: cachet
    values:
        image:
            repository: ghcr.io/mtrnord/cachet_docker
            tag: "2.4"
            pullPolicy: Always
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: letsencrypt-dns
                external-dns.alpha.kubernetes.io/hostname: midnightthoughts.space
            host: status.midnightthoughts.space
            tls:
                - secretName: status-midnightthoughts-space-tls
                  hosts:
                    - status.midnightthoughts.space
            database:
                host: postgres-cluster.postgres-cluster.svc.cluster.local
                port: 5432
                name: cachet
                username: cachet
                password: ENC[AES256_GCM,data:fLDnrYVWXthtK6bylaF/pYxGM9EBAvsszoPAghGdRorqPKnyoHMVgvt8ESF85I72Kq20PeV4vk2tKLjuHLiz6w==,iv:GPd4DmclNuQkjRrYCW9qj/jTKUT4lAqYd4jbecMSkSo=,tag:5gDKi7TnfDdHx7Cg78y+Pw==,type:str]
            env:
                public:
                    # Application environments
                    APP_DEBUG: false
                    APP_LOG: errorlog
                    DB_DRIVER: pgsql
                    DOCKER: true
                    CACHE_DRIVER: database
                    SESSION_DRIVER: database
                    QUEUE_DRIVER: database
                    CACHET_EMOJI: false
                    CACHET_BEACON: false
                    # Email find them here  https://docs.cachethq.io/docs/configuring-mail
                    MAIL_DRIVER: smtp
                    MAIL_HOST: smtp.fastmail.com
                    MAIL_ADDRESS: ops@nordgedanken.dev
                    MAIL_PORT: 465
                    MAIL_NAME: Midnightthoughts Status Page
                    MAIL_ENCRYPTION: tls
                private:
                    APP_KEY: ENC[AES256_GCM,data:wR+WxDAWW0zASEdBcbiwCtIAFBcAtdXfgN3YNtAoCIGCADE9+Krx4VN5M2ToTi7aUS2g,iv:MYUOtk/azK3RTGiyVVIEP6Tj68KgtDWBSZcgw9V2lYE=,tag:mARLade78GDi7ptaxFEV6g==,type:str]
                    MAIL_USERNAME: mtrnord@nordgedanken.dev
                    MAIL_PASSWORD: ENC[AES256_GCM,data:BnHwIsWueWNaeD6WYpjlng==,iv:l4adS2IXuh8+m35utL6mHkt07EP4lQUvBxCHkmMDNI0=,tag:ozIgs2KkGpVkF0VwiZfssg==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBhU3FpVFg0TkovYTZQQmtJ
            S21CN0R5cDZLOEE2NTgvdnBTNTVxR3RqOVhjCnBKWW9OKzBxMTBuV0ZBYTBVSDZS
            UUg2MSt1UE1uTk5VRHZTbGdOa2JQYXcKLS0tIHRQL1U0eUtIVnhleU5tL3VxeW93
            QVRWQ0RNR2ZQOHoxUkFibFBUeEUrNGsKKc8URw+VMSOZd8QRsd/8mHmWPOU3nyyP
            +SnDpgPs8dqaCNrgHHkxdaJdNqOjkwS4CiqZ3SSPTBO1gEwZArOqJQ==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-10-06T16:14:27Z"
    mac: ENC[AES256_GCM,data:Emn/w1T8UPQ2k9LOaRN4uVC4EobI3A87z5ci/7ow6LBZ9oOzUaifC58qVWQQ+0ja65c41iD7abFHKKExu9fzXzSuve9qCq5HSaFLSTvqkQThWrZgGCfTM6hqc84B4DaqIaW48km/Z6JsIsor7lHT0Fj2S8R7gC6aOyD3Vry+2Ts=,iv:rqUwI+U4xZofVM+HmcCZKhBuDN3ppd1BvWHRWN9VInQ=,tag:ReDFSIuK8lo0/IS/o77vvQ==,type:str]
    pgp: []
    encrypted_regex: ^(admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.8.1
