apiVersion: source.toolkit.fluxcd.io/v1beta2
kind: HelmRepository
metadata:
    name: csi-driver-smb
    namespace: kube-system
spec:
    interval: 24h
    url: https://raw.githubusercontent.com/kubernetes-csi/csi-driver-smb/master/charts
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBpbFdtWSt1bG81c2FWcDJR
            Z2dqRkxrME0rS3JYeVZjU2dYZ2R5dnBnRFV3CjZ2cXBPaTlzdG42c3oxclhLdzEx
            WkpzYTRBajZKNUV2dFdWT2JTSWtOUEEKLS0tIGpNVVFNOXhSaWErUUdibWJKeSsw
            dHUrMjZiV2RRV1Zlam5lTXdXM0dXaGsKZBgzp/EUd9jno5p0miRoBbZVK8zhn9B8
            2hrKoDoxvfRa+La6G3vRUHDloa84KsKdNQeRszXniQRCG8eLsUF2Ww==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-10-16T13:36:44Z"
    mac: ENC[AES256_GCM,data:/M4eujLjluL+xkn6VmhoUq82UAAc4h4wg/QW/Tu8tiuvTgkLbb9h/8PgF1id8dOKu713doTcqUl3fTNn9Ggk8mno8wcCiupXhUr7bwvqp2gLQnLJ01GpvvCNAnbQgj/fl9VGRGYC8rRJoq0oPRtiJAPe5KiL0FiVT8qLKwoJ844=,iv:ph79QFoWfkloGxUysowMzdmqnBhWybaCiB3sR8VTyYQ=,tag:yFAqmA9qV7zGUkg55wymVQ==,type:str]
    pgp: []
    encrypted_regex: ^(routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.8.1
---
apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: csi-driver-smb
    namespace: kube-system
spec:
    interval: 30m
    chart:
        spec:
            chart: csi-driver-smb
            version: v1.16.0
            sourceRef:
                kind: HelmRepository
                name: csi-driver-smb
                namespace: kube-system
            interval: 12h
    values: {}
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBpbFdtWSt1bG81c2FWcDJR
            Z2dqRkxrME0rS3JYeVZjU2dYZ2R5dnBnRFV3CjZ2cXBPaTlzdG42c3oxclhLdzEx
            WkpzYTRBajZKNUV2dFdWT2JTSWtOUEEKLS0tIGpNVVFNOXhSaWErUUdibWJKeSsw
            dHUrMjZiV2RRV1Zlam5lTXdXM0dXaGsKZBgzp/EUd9jno5p0miRoBbZVK8zhn9B8
            2hrKoDoxvfRa+La6G3vRUHDloa84KsKdNQeRszXniQRCG8eLsUF2Ww==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-10-16T13:36:44Z"
    mac: ENC[AES256_GCM,data:/M4eujLjluL+xkn6VmhoUq82UAAc4h4wg/QW/Tu8tiuvTgkLbb9h/8PgF1id8dOKu713doTcqUl3fTNn9Ggk8mno8wcCiupXhUr7bwvqp2gLQnLJ01GpvvCNAnbQgj/fl9VGRGYC8rRJoq0oPRtiJAPe5KiL0FiVT8qLKwoJ844=,iv:ph79QFoWfkloGxUysowMzdmqnBhWybaCiB3sR8VTyYQ=,tag:yFAqmA9qV7zGUkg55wymVQ==,type:str]
    pgp: []
    encrypted_regex: ^(routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.8.1
---
apiVersion: v1
kind: Secret
metadata:
    name: smbcreds
    namespace: kube-system
type: Opaque
stringData:
    username: ENC[AES256_GCM,data:hOdHnVoesQ==,iv:g+f2dwIPNZ0g/3v4n3adDBaWZa6evEZN4LeFq3yw0tU=,tag:DJyJb/C+RjXTWax+azo1OQ==,type:str]
    password: ENC[AES256_GCM,data:9b/ZpgRFlBrOQmwNFU09UQ==,iv:q4CtipYgPLN1zGDCqhUCZt2IU5LY1NUAKmC3zncPlNk=,tag:uo4Vlkrmh2pY9582EWBnHQ==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBpbFdtWSt1bG81c2FWcDJR
            Z2dqRkxrME0rS3JYeVZjU2dYZ2R5dnBnRFV3CjZ2cXBPaTlzdG42c3oxclhLdzEx
            WkpzYTRBajZKNUV2dFdWT2JTSWtOUEEKLS0tIGpNVVFNOXhSaWErUUdibWJKeSsw
            dHUrMjZiV2RRV1Zlam5lTXdXM0dXaGsKZBgzp/EUd9jno5p0miRoBbZVK8zhn9B8
            2hrKoDoxvfRa+La6G3vRUHDloa84KsKdNQeRszXniQRCG8eLsUF2Ww==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-10-16T13:36:44Z"
    mac: ENC[AES256_GCM,data:/M4eujLjluL+xkn6VmhoUq82UAAc4h4wg/QW/Tu8tiuvTgkLbb9h/8PgF1id8dOKu713doTcqUl3fTNn9Ggk8mno8wcCiupXhUr7bwvqp2gLQnLJ01GpvvCNAnbQgj/fl9VGRGYC8rRJoq0oPRtiJAPe5KiL0FiVT8qLKwoJ844=,iv:ph79QFoWfkloGxUysowMzdmqnBhWybaCiB3sR8VTyYQ=,tag:yFAqmA9qV7zGUkg55wymVQ==,type:str]
    pgp: []
    encrypted_regex: ^(routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.8.1
---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
    name: smb-storagebox
provisioner: smb.csi.k8s.io
parameters:
    source: //u362507.your-storagebox.de/backup
    csi.storage.k8s.io/provisioner-secret-name: smbcreds
    csi.storage.k8s.io/provisioner-secret-namespace: kube-system
    csi.storage.k8s.io/node-stage-secret-name: smbcreds
    csi.storage.k8s.io/node-stage-secret-namespace: kube-system
volumeBindingMode: Immediate
mountOptions:
    - dir_mode=0777
    - file_mode=0777
    - uid=1001
    - gid=1001
    - noperm
    - mfsymlinks
    - cache=strict
    # required to prevent data corruption
    - noserverino
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1esjyg2qfy49awv0ptkzvpk425adczjr38m37w2mmcahzc4p8n54sll2nzh
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBpbFdtWSt1bG81c2FWcDJR
            Z2dqRkxrME0rS3JYeVZjU2dYZ2R5dnBnRFV3CjZ2cXBPaTlzdG42c3oxclhLdzEx
            WkpzYTRBajZKNUV2dFdWT2JTSWtOUEEKLS0tIGpNVVFNOXhSaWErUUdibWJKeSsw
            dHUrMjZiV2RRV1Zlam5lTXdXM0dXaGsKZBgzp/EUd9jno5p0miRoBbZVK8zhn9B8
            2hrKoDoxvfRa+La6G3vRUHDloa84KsKdNQeRszXniQRCG8eLsUF2Ww==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-10-16T13:36:44Z"
    mac: ENC[AES256_GCM,data:/M4eujLjluL+xkn6VmhoUq82UAAc4h4wg/QW/Tu8tiuvTgkLbb9h/8PgF1id8dOKu713doTcqUl3fTNn9Ggk8mno8wcCiupXhUr7bwvqp2gLQnLJ01GpvvCNAnbQgj/fl9VGRGYC8rRJoq0oPRtiJAPe5KiL0FiVT8qLKwoJ844=,iv:ph79QFoWfkloGxUysowMzdmqnBhWybaCiB3sR8VTyYQ=,tag:yFAqmA9qV7zGUkg55wymVQ==,type:str]
    pgp: []
    encrypted_regex: ^(routing_key|DATABASE_URL|SMTP_PASSWORD|SECRET_KEY_BASE|admin_password|extraCommands|key|clickhouseDatabaseURL|databaseURL|client_id|client_secret|secret_key_base|otp_secret|private_key|public_key|primaryKey|deterministicKey|keyDerivationSalt|token|clientId|secretKey|installationId|installationKey|uriOverride|adminToken.value|password.value|sql_password|erlangCookie|AUTHENTICATION_PASSWORD|ROOM_API_SECRET_KEY|adminPassword|configPassword|adminUser|configUser|MAIL_PASSWORD|APP_KEY|api_key|api_secret|keys|livekit_key|livekit_secret|secret_key|admin_pass|admin_email|mariadbPassword|mariadbRootPassword|privateKey|data|stringData|PASSWD|password|pass|postgresPassword|postgresqlPassword|redminePassword|smtpPassword|registration_shared_secret|shared_secret|secret|admin_token|integrationKey|rootPassword)$
    version: 3.8.1
